import{_ as C,m as k,a as n,o,b as t,t as d,w as c,v as f,d as u,F as m,e as g,f as p,p as h,n as v}from"./app-xZFo10Vc.js";const w={name:"AgentCard",props:{item:{type:Object,required:!0},isMine:{type:Boolean,default:!1}},data(){return{csrfToken:document.querySelector('meta[name="csrf-token"]').getAttribute("content")}},methods:{labelVisibility(i){if(!i)return"—";const e=(i+"").toLowerCase();return e.includes("public")?"Agent public":e.includes("priv")?"Agent privé":i},fmt(i){return i?new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)+" €":"—"}},template:`
  <div class="card card-1 cardAgent">
    <div class="card-header pb-2">
      <center>
        <model-viewer
          v-if="item.avatar_url"
          :src="item.avatar_url"
          bounds="tight"
          camera-target="0m 1.60m 0m"
          camera-orbit="0deg 90deg 0.9m"
          field-of-view="15deg"
          interaction-prompt="none"
          style="width:180px; height:150px; background:transparent;"
          shadow-intensity="0.6"
          @error="() => { item.avatar_url = null }"
        />
        <img v-else src="/assets/img/dash/robot_smile.png" alt="" style="width:180px;height:180px;object-fit:contain;">
      </center>
      <h4 class="mt-2">{{ item.nom || item.name }}</h4>
    </div>

    <div class="card-body pb-0">
      <p>{{ item.description }}</p>
    </div>

    <div class="card-header pb-2">
      <h4 style="color:#FF8B33;">
        <i class="heroicons-outline/user"></i>
        {{ labelVisibility(item.type || item.visibility) }}
      </h4>
    </div>

    <!-- Boutons -->
    <center class="btns pt-3 flex gap-2 justify-center">
      <!-- Voir plus -->
      <a :href="\`/agentia/details/\${item.id}\`" class="btn btn-primary mb-2">
        Voir plus
      </a>

      <!-- Paiement : visible seulement si prix existe & pas mes agents -->
   <form 
  v-if="!isMine && item.total_price" 
  v-bind:action="'/agentia/' + item.id + '/pay'" 
  method="POST" 
  style="display:inline;"
>
  <input type="hidden" name="_token" :value="csrfToken">
  <button 
    type="submit" 
    class="btn mb-2 text-white" 
    style="background-color:#E65C00;"
  >
    {{ fmt(item.total_price) }}
  </button>
</form>



    </center>
  </div>
  `},A={name:"AgentsIAListe",components:{AgentCard:w},props:{mesagents:{type:Array,required:!0},marketplaceAgents:{type:Array,default:()=>[]},categories:{type:Array,default:()=>[]},kpiTotalAll:{type:[Number,null],default:null},kpiTotalMine:{type:[Number,null],default:null},kpiSalesRate:{type:[Number,null],default:null}},data(){return{searchMine:"",selectedCategoryMine:"",searchAll:"",selectedCategoryAll:"",selectedVisibility:"",sortBy:"recent",perPage:9,currentPage:1}},computed:{filteredAgentsMine(){let i=Array.isArray(this.mesagents)?this.mesagents.slice():[];if(this.searchMine&&this.searchMine.trim()){const e=this.searchMine.toLowerCase();i=i.filter(s=>((s.nom||s.name||"")+"").toLowerCase().includes(e)||((s.type||s.visibility||"")+"").toLowerCase().includes(e)||((s.description||"")+"").toLowerCase().includes(e)||((s.category&&s.category.name||"")+"").toLowerCase().includes(e)||((s.subcategory&&s.subcategory.name||"")+"").toLowerCase().includes(e))}return this.selectedCategoryMine&&(i=i.filter(e=>String(e.category_id)===String(this.selectedCategoryMine))),i},filteredMarketplace(){let i=Array.isArray(this.marketplaceAgents)?this.marketplaceAgents.slice():[];if(this.searchAll&&this.searchAll.trim()){const e=this.searchAll.toLowerCase();i=i.filter(s=>((s.nom||s.name||"")+"").toLowerCase().includes(e)||((s.type||s.visibility||"")+"").toLowerCase().includes(e)||((s.description||"")+"").toLowerCase().includes(e)||((s.category&&s.category.name||"")+"").toLowerCase().includes(e)||((s.subcategory&&s.subcategory.name||"")+"").toLowerCase().includes(e))}if(this.selectedCategoryAll&&(i=i.filter(e=>String(e.category_id)===String(this.selectedCategoryAll))),this.selectedVisibility){const e=this.selectedVisibility.toLowerCase();i=i.filter(s=>((s.type||s.visibility||"")+"").toLowerCase().includes(e))}return this.sortBy==="alpha"?i.sort((e,s)=>(e.nom||e.name||"").localeCompare(s.nom||s.name||"")):this.sortBy==="popular"?i.sort((e,s)=>(s.sold_count||0)-(e.sold_count||0)):i.sort((e,s)=>{const b=new Date(e.created_at||0).getTime()||e.id||0;return(new Date(s.created_at||0).getTime()||s.id||0)-b}),i},totalPages(){return Math.max(1,Math.ceil(this.filteredMarketplace.length/this.perPage))},paginatedMarketplace(){const i=(this.currentPage-1)*this.perPage;return this.filteredMarketplace.slice(i,i+this.perPage)}},watch:{searchAll(){this.currentPage=1},selectedCategoryAll(){this.currentPage=1},selectedVisibility(){this.currentPage=1},sortBy(){this.currentPage=1},perPage(){this.currentPage=1}},methods:{labelVisibility(i){if(!i)return"—";const e=(i+"").toLowerCase();return e.includes("public")?"Agent public":e.includes("priv")?"Agent privé":i}}},_={class:"row"},x={class:"col-12 mb-4"},M={class:"row g-3 kpi-row"},P={class:"col-lg-4 col-md-4 col-sm-6 col-12"},V={class:"kpi-card"},L={class:"kpi-value"},T={class:"col-lg-4 col-md-4 col-sm-6 col-12"},B={class:"kpi-card"},S={class:"kpi-value"},j={class:"col-lg-4 col-md-4 col-sm-6 col-12"},N={class:"kpi-card"},F={class:"kpi-value"},U={class:"col-12 mb-4"},D={class:"nav-align-top shadow-none mb-4"},q={class:"tab-content px-0"},I={class:"tab-pane fade show active",id:"navs-top-agents",role:"tabpanel"},R={class:"row filters"},Z={class:"col-lg-8 col-md-8 col-sm-8 col-12 d-lg-flex d-md-flex d-sm-flex d-block justify-content-start align-items-center"},E={class:"input-group me-2 mb-4"},O=["value"],z={class:"row"},G={key:0,class:"col-12"},H={class:"tab-pane fade",id:"navs-top-marketplace",role:"tabpanel"},J={class:"row filters"},K={class:"col-lg-9 col-md-9 col-sm-12 col-12 d-lg-flex d-md-flex d-sm-flex d-block justify-content-start align-items-center"},Q={class:"input-group me-2 mb-4"},W=["value"],X={class:"col-lg-3 col-md-3 col-sm-12 col-12 d-flex justify-content-end align-items-center"},Y={class:"d-flex gap-2 mb-4"},$={class:"row"},ee={key:0,class:"col-12"},te={key:0,class:"d-flex justify-content-center mt-3"},se={"aria-label":"Pagination agents"},le={class:"pagination"},ie=["onClick"];function ae(i,e,s,b,a,r){const y=k("AgentCard");return o(),n("div",_,[t("div",x,[t("div",M,[t("div",P,[t("div",V,[e[9]||(e[9]=t("img",{src:"/asset/img/logo2.png",alt:"",class:"kpi-icon"},null,-1)),e[10]||(e[10]=t("p",{class:"kpi-label"},"Nombre des agents en total",-1)),t("p",L,d(s.kpiTotalAll!=null?s.kpiTotalAll:Array.isArray(s.marketplaceAgents)?s.marketplaceAgents.length:"—"),1)])]),t("div",T,[t("div",B,[e[11]||(e[11]=t("img",{src:"/asset/img/logo3.png",alt:"",class:"kpi-icon"},null,-1)),e[12]||(e[12]=t("p",{class:"kpi-label"},"Nombre total de mes agents",-1)),t("p",S,d(s.kpiTotalMine!=null?s.kpiTotalMine:s.mesagents&&s.mesagents.length?s.mesagents.length:0),1)])]),t("div",j,[t("div",N,[e[13]||(e[13]=t("img",{src:"/asset/img/logo2.png",alt:"",class:"kpi-icon"},null,-1)),e[14]||(e[14]=t("p",{class:"kpi-label"},"Taux de gain de vente",-1)),t("p",F,d(s.kpiSalesRate!=null?s.kpiSalesRate+"%":"—"),1)])])])]),t("div",U,[t("div",D,[e[25]||(e[25]=t("ul",{class:"nav",role:"tablist"},[t("li",{class:"nav-item"},[t("button",{type:"button",class:"nav-link active",role:"tab","data-bs-toggle":"tab","data-bs-target":"#navs-top-agents","aria-controls":"navs-top-agents","aria-selected":"true"}," Mes agents IA ")]),t("li",{class:"nav-item"},[t("button",{type:"button",class:"nav-link",role:"tab","data-bs-toggle":"tab","data-bs-target":"#navs-top-solde","aria-controls":"navs-top-solde","aria-selected":"false"}," Solde de vente des agents ")]),t("li",{class:"nav-item"},[t("button",{type:"button",class:"nav-link",role:"tab","data-bs-toggle":"tab","data-bs-target":"#navs-top-marketplace","aria-controls":"navs-top-marketplace","aria-selected":"false"}," Marketplace ")])],-1)),t("div",q,[t("div",I,[t("div",R,[t("div",Z,[t("div",E,[e[15]||(e[15]=t("span",{class:"input-group-text"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"19",height:"19",viewBox:"0 0 19 19",fill:"none"},[t("path",{d:"M17.8749 18L12.4244 12.3333M1.52344 7.61111C1.52344 8.47929 1.68792 9.33898 2.00748 10.1411C2.32705 10.9432 2.79544 11.672 3.38592 12.2859C3.9764 12.8998 4.6774 13.3867 5.4489 13.719C6.22039 14.0512 7.04728 14.2222 7.88234 14.2222C8.71741 14.2222 9.54429 14.0512 10.3158 13.719C11.0873 13.3867 11.7883 12.8998 12.3788 12.2859C12.9692 11.672 13.4376 10.9432 13.7572 10.1411C14.0768 9.33898 14.2412 8.47929 14.2412 7.61111C14.2412 6.74293 14.0768 5.88325 13.7572 5.08115C13.4376 4.27905 12.9692 3.55025 12.3788 2.93635C11.7883 2.32245 11.0873 1.83548 10.3158 1.50324C9.54429 1.171 8.71741 1 7.88234 1C7.04728 1 6.22039 1.171 5.4489 1.50324C4.6774 1.83548 3.9764 2.32245 3.38592 2.93635C2.79544 3.55025 2.32705 4.27905 2.00748 5.08115C1.68792 5.88325 1.52344 6.74293 1.52344 7.61111Z",stroke:"#C6C6C6","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>a.searchMine=l),type:"text",class:"form-control",placeholder:"Chercher"},null,512),[[f,a.searchMine]])]),c(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>a.selectedCategoryMine=l),class:"form-select mb-4"},[e[16]||(e[16]=t("option",{value:""},"Tous les domaines",-1)),(o(!0),n(m,null,g(s.categories,l=>(o(),n("option",{key:l.id,value:l.id},d(l.name),9,O))),128))],512),[[u,a.selectedCategoryMine]])]),e[17]||(e[17]=t("div",{class:"col-lg-4 col-md-4 col-sm-4 col-12 d-lg-flex d-md-flex d-sm-flex d-block justify-content-end align-items-center"},[t("a",{href:"/agentia/add",class:"btn btn-primary fs-sm mb-4"}," Ajouter un agent IA ")],-1))]),t("div",z,[r.filteredAgentsMine.length===0?(o(),n("div",G,e[18]||(e[18]=[t("div",{class:"alert alert-info"},"Aucun agent trouvé.",-1)]))):p("",!0),(o(!0),n(m,null,g(r.filteredAgentsMine,l=>(o(),n("div",{key:l.id,class:"col-lg-4 col-md-4 col-sm-6 col-12 mb-4"},[h(y,{item:l},null,8,["item"])]))),128))])]),t("div",H,[t("div",J,[t("div",K,[t("div",Q,[e[19]||(e[19]=t("span",{class:"input-group-text"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"19",height:"19",viewBox:"0 0 19 19",fill:"none"},[t("path",{d:"M17.8749 18L12.4244 12.3333M1.52344 7.61111C1.52344 8.47929 1.68792 9.33898 2.00748 10.1411C2.32705 10.9432 2.79544 11.672 3.38592 12.2859C3.9764 12.8998 4.6774 13.3867 5.4489 13.719C6.22039 14.0512 7.04728 14.2222 7.88234 14.2222C8.71741 14.2222 9.54429 14.0512 10.3158 13.719C11.0873 13.3867 11.7883 12.8998 12.3788 12.2859C12.9692 11.672 13.4376 10.9432 13.7572 10.1411C14.0768 9.33898 14.2412 8.47929 14.2412 7.61111C14.2412 6.74293 14.0768 5.88325 13.7572 5.08115C13.4376 4.27905 12.9692 3.55025 12.3788 2.93635C11.7883 2.32245 11.0873 1.83548 10.3158 1.50324C9.54429 1.171 8.71741 1 7.88234 1C7.04728 1 6.22039 1.171 5.4489 1.50324C4.6774 1.83548 3.9764 2.32245 3.38592 2.93635C2.79544 3.55025 2.32705 4.27905 2.00748 5.08115C1.68792 5.88325 1.52344 6.74293 1.52344 7.61111Z",stroke:"#C6C6C6","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.searchAll=l),type:"text",class:"form-control",placeholder:"Chercher dans la marketplace"},null,512),[[f,a.searchAll]])]),c(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>a.selectedCategoryAll=l),class:"form-select mb-4 me-2"},[e[20]||(e[20]=t("option",{value:""},"Tous les domaines",-1)),(o(!0),n(m,null,g(s.categories,l=>(o(),n("option",{key:l.id,value:l.id},d(l.name),9,W))),128))],512),[[u,a.selectedCategoryAll]]),c(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>a.selectedVisibility=l),class:"form-select mb-4"},e[21]||(e[21]=[t("option",{value:""},"Toutes visibilités",-1),t("option",{value:"public"},"Public",-1),t("option",{value:"private"},"Privée",-1)]),512),[[u,a.selectedVisibility]])]),t("div",X,[t("div",Y,[c(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>a.sortBy=l),class:"form-select"},e[22]||(e[22]=[t("option",{value:"recent"},"Plus récents",-1),t("option",{value:"alpha"},"A → Z",-1),t("option",{value:"popular"},"Populaires",-1)]),512),[[u,a.sortBy]]),c(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>a.perPage=l),class:"form-select"},e[23]||(e[23]=[t("option",{value:6},"6 / page",-1),t("option",{value:9},"9 / page",-1),t("option",{value:12},"12 / page",-1)]),512),[[u,a.perPage,void 0,{number:!0}]])])])]),t("div",$,[r.paginatedMarketplace.length===0?(o(),n("div",ee,e[24]||(e[24]=[t("div",{class:"alert alert-info"},"Aucun agent trouvé dans la marketplace.",-1)]))):p("",!0),(o(!0),n(m,null,g(r.paginatedMarketplace,l=>(o(),n("div",{key:l.id,class:"col-lg-4 col-md-4 col-sm-6 col-12 mb-4"},[h(y,{item:l},null,8,["item"])]))),128))]),r.totalPages>1?(o(),n("div",te,[t("nav",se,[t("ul",le,[t("li",{class:v(["page-item",{disabled:a.currentPage===1}])},[t("button",{class:"page-link",onClick:e[7]||(e[7]=l=>a.currentPage=Math.max(1,a.currentPage-1))},"Précédent")],2),(o(!0),n(m,null,g(r.totalPages,l=>(o(),n("li",{class:v(["page-item",{active:a.currentPage===l}]),key:l},[t("button",{class:"page-link",onClick:ne=>a.currentPage=l},d(l),9,ie)],2))),128)),t("li",{class:v(["page-item",{disabled:a.currentPage===r.totalPages}])},[t("button",{class:"page-link",onClick:e[8]||(e[8]=l=>a.currentPage=Math.min(r.totalPages,a.currentPage+1))},"Suivant")],2)])])])):p("",!0)])])])])])}const re=C(A,[["render",ae],["__scopeId","data-v-ea137cae"]]);export{re as default};
