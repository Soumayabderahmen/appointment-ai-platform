import{_ as F,r as x,c as I,a as o,o as n,b as l,f as S,w as a,v as i,t as p,F as v,e as b,n as m,j as g,d as k,z,A as U,h as A,l as V,W as B}from"./app-xZFo10Vc.js";const D={class:"container mt-4"},_={class:"mb-4 ai-autofill-whitecard"},N={class:"ai-body d-flex gap-2"},q=["disabled"],$={class:"partner-stepper mb-6"},G={class:"steps-container flex items-center justify-between"},W=["onClick"],J={class:"step-circle"},H={class:"step-label text-xs mt-1"},K={key:0,class:"space-y-6"},Q={key:0,class:"input-custom bg-gray-100"},X={class:"flex flex-wrap gap-2"},Y=["value"],Z={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},h=["value"],ee={class:"checkbox-label"},le={key:0},te=["src"],se={key:1,class:"jointe"},ae={key:1,class:"space-y-6"},oe={class:"grid grid-cols-2 gap-3"},ne=["value"],ie={class:"checkbox-label"},ue={key:2,class:"space-y-6"},re={class:"text-sm text-gray-600 mt-1"},de={key:3,class:"space-y-6"},pe={key:4,class:"space-y-6"},ve={class:"grid grid-cols-2 gap-3"},me=["value"],be={class:"checkbox-label"},ge={key:5,class:"space-y-6"},ce={class:"flex items-center gap-2 mt-3"},ye={class:"flex justify-between mt-6"},fe={__name:"FundingForm",setup(xe){const c=["Informations générales","Éligibilité","Montants & Calendrier","Procédure","Livrables & Visuels","SEO"],y=x(""),f=x(!1),u=x(1),s=x({title:"",funding_type:"",description:"",operator:"",geographic_scope:"",sectors:[],keywords:"",beneficiaries:[],cover_image:"",project_stage:"",eligibility_status:"",amount_min:null,amount_max:null,coverage_rate:0,open_date:"",close_date:"",instruction_delay:"",application_link:"",operator_contact:"",application_steps:[],deliverables:[],internal_notes:"",operator_logo:"",cover_banner:"",seo_slug:"",seo_meta_title:"",seo_meta_description:"",seo_indexation:!0});async function P(){if(!y.value){alert("Veuillez entrer une URL");return}try{f.value=!0;const d=await A.post("/api/n8n/analyze",{url:y.value},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log("Réponse brute n8n :",d.data);const e=Array.isArray(d.data)?d.data[0]:d.data;if(!e||Object.keys(e).length===0){V.error("❌Réponse vide reçue de n8n");return}Object.assign(s.value,e),console.log("Formulaire après remplissage :",s.value),V.success("✅ Champs pré-remplis via n8n")}catch(d){console.error("Erreur analyse URL :",d),V.error("❌ Erreur lors de l’analyse du lien")}finally{f.value=!1}}const w=[{value:"national",label:"National"},{value:"regional",label:"Régional"},{value:"ue",label:"UE"},{value:"local",label:"Local"}],M=["Startup de moins de 3 ans","PME","Association","Portage projet personnel","Étudiant entrepreneur"],j=["Pitch Deck","Business Plan","Cahier des charges","Budget prévisionnel","Pièces administratives"],O=["FoodTech","EdTech","IA","GreenTech","Santé","SaaS","Impact","Autres"],C=I({get:()=>(s.value.application_steps||[]).join(`
`),set:d=>{s.value.application_steps=d.split(`
`).filter(e=>e.trim())}});function E(d){u.value=d}function T(){u.value<c.length&&u.value++}function L(){u.value>1&&u.value--}async function R(){try{const d=await A.post("/api/n8n/fundings",s.value,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});V.success("✅ Ajout réussi !"),setTimeout(()=>{B.push("/admin/list/Publication")},700)}catch(d){console.error(d),alert("❌ Erreur lors de l’ajout")}}return(d,e)=>(n(),o("div",D,[l("div",_,[e[32]||(e[32]=l("div",{class:"ai-header d-flex align-items-center gap-3 mb-3"},[l("img",{src:"/assets/img1/robot.png",alt:"Bot",class:"ai-bot-img",style:{width:"38px",height:"38px"}}),l("span",{class:"ai-title"},"Agent IA de Pré-remplissage")],-1)),l("div",N,[a(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),type:"text",placeholder:"Collez l’URL ici...",class:"input-custom"},null,512),[[i,y.value]]),l("button",{onClick:P,disabled:f.value},p(f.value?"Analyse en cours...":"Analyser URL"),9,q),e[31]||(e[31]=l("button",{type:"button",class:"btn btn-outline-primary fs-sm"},"Vider",-1))])]),l("div",$,[l("div",G,[(n(),o(v,null,b(c,(t,r)=>(n(),o(v,{key:r},[l("div",{class:m(["step flex flex-col items-center cursor-pointer",{active:u.value===r+1,done:u.value>r+1,clickable:u.value>r+1}]),onClick:ke=>E(r+1)},[l("div",J,p(r+1),1),l("div",H,p(t),1)],10,W),r<c.length-1?(n(),o("div",{key:0,class:m(["step-line flex-1",{"line-active":u.value===r+1,"line-done":u.value>r+1}])},null,2)):S("",!0)],64))),64))])]),u.value===1?(n(),o("div",K,[e[43]||(e[43]=l("h2",{class:"informations-gnrales"},"Informations générales",-1)),e[44]||(e[44]=l("p",{class:"reprsente-un-champ"},"* Représente un champ obligatoire",-1)),l("div",null,[e[33]||(e[33]=l("label",{class:"form-label"},[g("Nom du dispositif "),l("span",{class:"span"},"*")],-1)),a(l("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.title=t),type:"text",class:"input-custom",placeholder:"Écrire un nom..."},null,512),[[i,s.value.title]])]),l("div",null,[e[35]||(e[35]=l("label",{class:"form-label"},[g("Type de financement "),l("span",{class:"span"},"*")],-1)),s.value.funding_type?(n(),o("div",Q,p(s.value.funding_type),1)):a((n(),o("select",{key:1,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.funding_type=t),class:"select-custom"},e[34]||(e[34]=[l("option",{value:""},"Sélectionner un type",-1),l("option",{value:"subvention"},"Subvention",-1),l("option",{value:"pret"},"Prêt",-1),l("option",{value:"avance_remboursable"},"Avance remboursable",-1)]),512)),[[k,s.value.funding_type]])]),l("div",null,[e[36]||(e[36]=l("label",{class:"form-label"},"Description",-1)),a(l("textarea",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.description=t),rows:"4",class:"textarea-custom",placeholder:"Écrire ici..."},null,512),[[i,s.value.description]])]),l("div",null,[e[37]||(e[37]=l("label",{class:"form-label"},[g("Opérateur / Organisme "),l("span",{class:"span"},"*")],-1)),a(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.value.operator=t),type:"text",class:"input-custom",placeholder:"Ex: Région Nouvelle-Aquitaine"},null,512),[[i,s.value.operator]])]),l("div",null,[e[38]||(e[38]=l("label",{class:"form-label"},[g("Périmètre géographique "),l("span",{class:"span"},"*")],-1)),l("div",X,[(n(),o(v,null,b(w,t=>l("label",{key:t.value,class:m(["inline-flex items-center px-4 py-2 rounded-full border cursor-pointer transition-all",{"bg-blue-50 border-blue-500 text-blue-700":s.value.geographic_scope===t.value,"bg-white border-gray-300 text-gray-700":s.value.geographic_scope!==t.value}])},[a(l("input",{type:"radio",value:t.value,"onUpdate:modelValue":e[5]||(e[5]=r=>s.value.geographic_scope=r),class:"sr-only"},null,8,Y),[[z,s.value.geographic_scope]]),l("span",null,p(t.label),1)],2)),64))])]),l("div",null,[e[39]||(e[39]=l("label",{class:"form-label"},[g("Secteurs concernés "),l("span",{class:"span"},"*")],-1)),l("div",Z,[(n(),o(v,null,b(O,t=>l("label",{key:t,class:"checkbox-option"},[a(l("input",{type:"checkbox",value:t,"onUpdate:modelValue":e[6]||(e[6]=r=>s.value.sectors=r),class:"hidden"},null,8,h),[[U,s.value.sectors]]),l("div",{class:m(["checkbox-box",{active:s.value.sectors.includes(t)}])},null,2),l("span",ee,p(t),1)])),64))])]),l("div",null,[e[41]||(e[41]=l("label",{class:"form-label"},"Image de couverture",-1)),s.value.cover_image?(n(),o("div",le,[l("img",{src:s.value.cover_image,alt:"Cover banner",class:"h-32 rounded mb-2"},null,8,te),a(l("input",{type:"hidden","onUpdate:modelValue":e[7]||(e[7]=t=>s.value.cover_image=t)},null,512),[[i,s.value.cover_image]]),l("button",{type:"button",class:"px-2 py-1 bg-red-500 text-white text-xs rounded",onClick:e[8]||(e[8]=t=>s.value.cover_image="")}," Supprimer ")])):(n(),o("div",se,[e[40]||(e[40]=l("label",{for:"file-upload"},"Cliquez pour sélectionner une image (PNG, JPG, max 5MB)",-1)),l("input",{id:"file-upload",type:"file",class:"hidden",onChange:e[9]||(e[9]=(...t)=>d.handleFileUpload&&d.handleFileUpload(...t))},null,32)]))]),l("div",null,[e[42]||(e[42]=l("label",{class:"form-label"},"Mot-clés (Optionnel)",-1)),a(l("input",{"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.keywords=t),type:"text",class:"input-custom",placeholder:"Ajoutez des mots-clés"},null,512),[[i,s.value.keywords]])])])):u.value===2?(n(),o("div",ae,[e[50]||(e[50]=l("h2",{class:"informations-gnrales"},"Éligibilité",-1)),l("div",null,[e[45]||(e[45]=l("label",{class:"form-label"},"Profils bénéficiaires *",-1)),l("div",oe,[(n(),o(v,null,b(M,t=>l("label",{class:"checkbox-option",key:t},[a(l("input",{type:"checkbox",value:t,"onUpdate:modelValue":e[11]||(e[11]=r=>s.value.beneficiaries=r),class:"hidden"},null,8,ne),[[U,s.value.beneficiaries]]),l("div",{class:m(["checkbox-box",{active:s.value.beneficiaries.includes(t)}])},null,2),l("span",ie,p(t),1)])),64))])]),l("div",null,[e[47]||(e[47]=l("label",{class:"form-label"},"Stade du projet *",-1)),a(l("select",{"onUpdate:modelValue":e[12]||(e[12]=t=>s.value.project_stage=t),class:"select-custom"},e[46]||(e[46]=[l("option",{value:"Idée"},"Idée",-1),l("option",{value:"MVP"},"MVP",-1),l("option",{value:"Traction"},"Traction",-1),l("option",{value:"Croissance"},"Croissance",-1)]),512),[[k,s.value.project_stage]])]),l("div",null,[e[49]||(e[49]=l("label",{class:"form-label"},"Statut d’éligibilité *",-1)),a(l("select",{"onUpdate:modelValue":e[13]||(e[13]=t=>s.value.eligibility_status=t),class:"select-custom"},e[48]||(e[48]=[l("option",{value:"Ouvert"},"Ouvert",-1),l("option",{value:"À venir"},"À venir",-1),l("option",{value:"Clôturé"},"Clôturé",-1),l("option",{value:"Au fil de l’eau"},"Au fil de l’eau",-1)]),512),[[k,s.value.eligibility_status]])])])):u.value===3?(n(),o("div",ue,[e[58]||(e[58]=l("h2",{class:"informations-gnrales"},"Montants & Calendrier",-1)),l("div",null,[e[51]||(e[51]=l("label",{class:"form-label"},"Montant minimum (€)",-1)),a(l("input",{type:"number","onUpdate:modelValue":e[14]||(e[14]=t=>s.value.amount_min=t),class:"input-custom"},null,512),[[i,s.value.amount_min]])]),l("div",null,[e[52]||(e[52]=l("label",{class:"form-label"},"Montant maximum (€)",-1)),a(l("input",{type:"number","onUpdate:modelValue":e[15]||(e[15]=t=>s.value.amount_max=t),class:"input-custom"},null,512),[[i,s.value.amount_max]])]),l("div",null,[e[53]||(e[53]=l("label",{class:"form-label"},"Taux de prise en charge (%)",-1)),a(l("input",{type:"range",min:"0",max:"100","onUpdate:modelValue":e[16]||(e[16]=t=>s.value.coverage_rate=t),class:"w-full"},null,512),[[i,s.value.coverage_rate]]),l("p",re,p(s.value.coverage_rate)+"%",1)]),l("div",null,[e[54]||(e[54]=l("label",{class:"form-label"},"Ouverture des candidatures *",-1)),a(l("input",{type:"date","onUpdate:modelValue":e[17]||(e[17]=t=>s.value.open_date=t),class:"input-custom"},null,512),[[i,s.value.open_date]])]),l("div",null,[e[55]||(e[55]=l("label",{class:"form-label"},"Clôture des candidatures *",-1)),a(l("input",{type:"date","onUpdate:modelValue":e[18]||(e[18]=t=>s.value.close_date=t),class:"input-custom"},null,512),[[i,s.value.close_date]])]),l("div",null,[e[57]||(e[57]=l("label",{class:"form-label"},"Délai moyen d’instruction",-1)),a(l("select",{"onUpdate:modelValue":e[19]||(e[19]=t=>s.value.instruction_delay=t),class:"select-custom"},e[56]||(e[56]=[l("option",{value:""},"Sélectionner",-1),l("option",{value:"Moins de 4 semaines"},"Moins de 4 semaines",-1),l("option",{value:"4 à 8 semaines"},"4 à 8 semaines",-1),l("option",{value:"Plus de 8 semaines"},"Plus de 8 semaines",-1)]),512),[[k,s.value.instruction_delay]])])])):u.value===4?(n(),o("div",de,[e[62]||(e[62]=l("h2",{class:"informations-gnrales"},"Procédure",-1)),l("div",null,[e[59]||(e[59]=l("label",{class:"form-label"},"Lien officiel de candidature *",-1)),a(l("input",{"onUpdate:modelValue":e[20]||(e[20]=t=>s.value.application_link=t),type:"text",class:"input-custom",placeholder:"https://..."},null,512),[[i,s.value.application_link]])]),l("div",null,[e[60]||(e[60]=l("label",{class:"form-label"},"Contact opérateur",-1)),a(l("input",{"onUpdate:modelValue":e[21]||(e[21]=t=>s.value.operator_contact=t),type:"text",class:"input-custom",placeholder:"Email ou téléphone"},null,512),[[i,s.value.operator_contact]])]),l("div",null,[e[61]||(e[61]=l("label",{class:"form-label"},"Étapes de candidature",-1)),a(l("textarea",{"onUpdate:modelValue":e[22]||(e[22]=t=>C.value=t),class:"textarea-custom",placeholder:`1. ...
2. ...`},null,512),[[i,C.value]])])])):u.value===5?(n(),o("div",pe,[e[67]||(e[67]=l("h2",{class:"informations-gnrales"},"Livrables & Visuels",-1)),l("div",null,[e[63]||(e[63]=l("label",{class:"form-label"},"Documents requis",-1)),l("div",ve,[(n(),o(v,null,b(j,t=>l("label",{key:t,class:"checkbox-option"},[a(l("input",{type:"checkbox",value:t,"onUpdate:modelValue":e[23]||(e[23]=r=>s.value.deliverables=r),class:"hidden"},null,8,me),[[U,s.value.deliverables]]),l("div",{class:m(["checkbox-box",{active:s.value.deliverables.includes(t)}])},null,2),l("span",be,p(t),1)])),64))])]),l("div",null,[e[64]||(e[64]=l("label",{class:"form-label"},"Notes internes",-1)),a(l("textarea",{"onUpdate:modelValue":e[24]||(e[24]=t=>s.value.internal_notes=t),class:"textarea-custom"},null,512),[[i,s.value.internal_notes]])]),l("div",null,[e[65]||(e[65]=l("label",{class:"form-label"},"Logo opérateur",-1)),a(l("input",{"onUpdate:modelValue":e[25]||(e[25]=t=>s.value.operator_logo=t),type:"text",class:"input-custom",placeholder:"URL du logo"},null,512),[[i,s.value.operator_logo]])]),l("div",null,[e[66]||(e[66]=l("label",{class:"form-label"},"Bannière de couverture",-1)),a(l("input",{"onUpdate:modelValue":e[26]||(e[26]=t=>s.value.cover_banner=t),type:"text",class:"input-custom",placeholder:"URL de l’image"},null,512),[[i,s.value.cover_banner]])])])):u.value===6?(n(),o("div",ge,[e[72]||(e[72]=l("h2",{class:"informations-gnrales"},"SEO",-1)),l("div",null,[e[68]||(e[68]=l("label",{class:"form-label"},"Slug SEO",-1)),a(l("input",{"onUpdate:modelValue":e[27]||(e[27]=t=>s.value.seo_slug=t),type:"text",class:"input-custom",placeholder:"slug-de-mon-dispositif"},null,512),[[i,s.value.seo_slug]])]),l("div",null,[e[69]||(e[69]=l("label",{class:"form-label"},"Meta Title",-1)),a(l("input",{"onUpdate:modelValue":e[28]||(e[28]=t=>s.value.seo_meta_title=t),type:"text",class:"input-custom",placeholder:"Titre optimisé pour le SEO"},null,512),[[i,s.value.seo_meta_title]])]),l("div",null,[e[70]||(e[70]=l("label",{class:"form-label"},"Meta Description",-1)),a(l("textarea",{"onUpdate:modelValue":e[29]||(e[29]=t=>s.value.seo_meta_description=t),class:"textarea-custom",placeholder:"Description optimisée SEO..."},null,512),[[i,s.value.seo_meta_description]])]),l("div",ce,[a(l("input",{type:"checkbox","onUpdate:modelValue":e[30]||(e[30]=t=>s.value.seo_indexation=t)},null,512),[[U,s.value.seo_indexation]]),e[71]||(e[71]=l("span",{class:"text-sm text-gray-700"},"Autoriser l’indexation par les moteurs de recherche",-1))])])):S("",!0),l("div",ye,[u.value>1?(n(),o("button",{key:0,onClick:L,class:"px-4 py-2 bg-gray-200 rounded"},"Précédent")):S("",!0),u.value<c.length?(n(),o("button",{key:1,onClick:T,class:"ml-auto px-4 py-2 bg-blue-600 text-white rounded"},"Suivant")):(n(),o("button",{key:2,onClick:R,class:"ml-auto px-4 py-2 bg-green-600 text-white rounded"},"Soumettre"))])]))}},Ve=F(fe,[["__scopeId","data-v-5be87097"]]);export{Ve as default};
