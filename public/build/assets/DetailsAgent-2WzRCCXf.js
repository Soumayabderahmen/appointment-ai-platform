import{_ as C,r as f,a,o,b as e,t as c,f as x,i as F,w as m,v,d as N,F as b,e as y,j as S,h as w,l as h}from"./app-xZFo10Vc.js";const T={class:"row"},E={class:"col-12 mb-5"},B={class:"card card-1 cardDetailsAgent"},$={class:"card-body"},O=["src"],P={class:"title d-flex justify-content-between align-items-start"},I={class:"d-flex align-items-center"},J={key:0,class:"modal-overlay"},L={class:"modal-content"},R={class:"form-group"},q={class:"form-group"},z={class:"form-group"},G={class:"form-group"},H={class:"form-group"},K=["src"],Q=["onUpdate:modelValue"],W=["onUpdate:modelValue"],X={class:"col-12 mb-5"},Y={class:"card card-1 cardTimeline"},Z={class:"card-body"},ee={class:"timeline mb-0"},te={class:"timeline-event p-3",style:{"margin-left":"-24px"}},se={class:"timeline-heet on the flightader mb-3"},le={class:"mb-0"},ne={class:"content"},ae={__name:"DetailsAgent",props:{agent:Object},setup(V){var k;const d=V,i=f(d.agent),g=f(!1),n=f({}),j=()=>{var l;n.value={name:d.agent.name,domain:d.agent.domain,description:d.agent.description,type:d.agent.type,image:null,sections:((l=d.agent.sections)==null?void 0:l.map(t=>{var s;return{id:t.id,title:t.title,tasks:((s=t.tasks)==null?void 0:s.map(r=>({id:r.id,content:r.content})))||[]}}))||[]},g.value=!0},D=l=>{const t=l.target.files[0];t&&(n.value.image=t)},U=async()=>{try{const l=new FormData;l.append("name",n.value.name),l.append("domain",n.value.domain),l.append("description",n.value.description),l.append("type",n.value.type),n.value.image&&l.append("image",n.value.image),l.append("sections",JSON.stringify(n.value.sections)),await w.post(`/api/admin/agent/${d.agent.id}/update`,l,{headers:{"Content-Type":"multipart/form-data"}}),await A(),g.value=!1,h.success("Agent mis à jour avec succès.")}catch(l){console.error(" Erreur lors de la mise à jour :",l),h.error("Une erreur est survenue lors de la mise à jour de l’agent.")}},_=f([]);_.value=((k=i.value.sections)==null?void 0:k.map(l=>{var t;return{title:l.title,tasks:(t=l.tasks)==null?void 0:t.map(s=>s.content)}}))||[];const A=async()=>{var l;try{const t=await w.get(`/api/admin/agent/${d.agent.id}`);i.value=t.data,_.value=((l=i.value.sections)==null?void 0:l.map(s=>{var r;return{title:s.title,tasks:(r=s.tasks)==null?void 0:r.map(u=>u.content)}}))||[]}catch(t){console.error(" Erreur fetch agent :",t)}};return(l,t)=>(o(),a("div",T,[e("div",E,[e("div",B,[e("div",$,[e("img",{src:"/storage/"+i.value.image,alt:"Agent IA",class:"image"},null,8,O),e("div",null,[t[13]||(t[13]=e("br",null,null,-1)),e("div",P,[e("h5",null,c(i.value.name),1),e("div",I,[e("button",{onClick:j,class:"btn btn-primary"}," Modifier "),g.value?(o(),a("div",J,[e("div",L,[e("button",{onClick:t[0]||(t[0]=s=>g.value=!1),class:"close-btn"}," × "),e("form",{onSubmit:F(U,["prevent"])},[e("div",R,[t[5]||(t[5]=e("label",null,"Nom de l'agent",-1)),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.value.name=s),type:"text",class:"form-control"},null,512),[[v,n.value.name]])]),e("div",q,[t[6]||(t[6]=e("label",null,"Domaine",-1)),m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.domain=s),type:"text",class:"form-control"},null,512),[[v,n.value.domain]])]),e("div",z,[t[8]||(t[8]=e("label",null,"Type",-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.type=s),class:"form-control"},t[7]||(t[7]=[e("option",{value:"public"}," Public ",-1),e("option",{value:"private"}," Privé ",-1)]),512),[[N,n.value.type]])]),e("div",G,[t[9]||(t[9]=e("label",null,"Description",-1)),m(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.value.description=s),class:"form-control"},null,512),[[v,n.value.description]])]),e("div",H,[t[10]||(t[10]=e("label",null,"Image de couverture",-1)),i.value.image?(o(),a("img",{key:0,src:"/storage/"+i.value.image,class:"w-24 h-24 object-cover mb-2"},null,8,K)):x("",!0),e("input",{type:"file",onChange:D,class:"form-control"},null,32)]),(o(!0),a(b,null,y(n.value.sections,(s,r)=>(o(),a("div",{key:r,class:"form-group border p-3 mb-3 rounded bg-light"},[t[11]||(t[11]=e("div",{class:"d-flex justify-between align-items-center mb-2"},[e("label",{class:"mb-0"},"Sous-titre")],-1)),m(e("input",{"onUpdate:modelValue":u=>s.title=u,class:"form-control mb-3"},null,8,Q),[[v,s.title]]),(o(!0),a(b,null,y(s.tasks,(u,p)=>(o(),a("div",{key:p,class:"d-flex align-items-center mb-2"},[m(e("input",{"onUpdate:modelValue":M=>s.tasks[p].content=M,class:"form-control me-2"},null,8,W),[[v,s.tasks[p].content]])]))),128))]))),128)),t[12]||(t[12]=e("div",{class:"text-right mt-4"},[e("button",{type:"submit",class:"btn btn-success"}," Mettre à jour ")],-1))],32)])])):x("",!0)])]),t[14]||(t[14]=e("br",null,null,-1)),e("h6",null,c(i.value.domain),1),t[15]||(t[15]=e("br",null,null,-1)),e("p",null,c(i.value.description),1)])])])]),e("div",X,[e("div",Y,[t[18]||(t[18]=e("div",{class:"card-header"},[e("h5",null,"Responsabilité")],-1)),e("div",Z,[e("ul",ee,[(o(!0),a(b,null,y(_.value,(s,r)=>(o(),a("li",{key:r,class:"timeline-item timeline-item-transparent",style:{"margin-left":"26px"}},[t[17]||(t[17]=e("span",{class:"timeline-point timeline-point-primary"},null,-1)),e("div",te,[e("div",se,[e("h6",le,c(s.title),1)]),e("div",ne,[e("ul",null,[(o(!0),a(b,null,y(s.tasks,(u,p)=>(o(),a("li",{key:p},[t[16]||(t[16]=e("img",{src:"/assets/img/dash/fleche.png",alt:""},null,-1)),S(" "+c(u),1)]))),128))])])])]))),128))])])])])]))}},ie=C(ae,[["__scopeId","data-v-7801c85d"]]);export{ie as default};
