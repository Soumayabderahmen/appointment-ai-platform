import{r as d,k as f,m as y,a as l,o as r,b as e,C as b,f as _,F as w,e as k,n as m,t as v,w as j,v as C,G as B,h as M,H as T}from"./app-xZFo10Vc.js";const q={class:"flex flex-col h-screen bg-gray-50"},V={class:"flex items-center justify-center bg-blue-100 py-4"},D={key:1,src:"/assets/img/dash/robot_smile_2.png",alt:"avatar",style:{width:"220px",height:"220px","object-fit":"contain"}},E={class:"flex-1 overflow-y-auto p-4 space-y-4",ref:"chatContainer"},F={key:0,class:"flex justify-start"},H={class:"max-w-md bg-gray-200 text-gray-500 p-3 rounded-xl italic"},K={class:"border-t bg-white p-3 flex items-center space-x-2"},S={__name:"Chat",props:{agent:{type:Object,required:!0}},setup(i){const t=d(""),n=d([]),c=d(!1),g=i;f(()=>{n.value.push({text:`Bonjour, je suis ${g.agent.nom}. Comment je peux aider ?`,sender:"bot"})});async function p(){if(!t.value.trim())return;n.value.push({text:t.value,sender:"user"}),u();const s=t.value;t.value="";try{c.value=!0;const a=await M.post("/api/chat/ask",{agent:g.agent.id,question:s});c.value=!1,n.value.push({text:a.data.answer,sender:"bot"}),u()}catch(a){console.error(a),c.value=!1,n.value.push({text:"Erreur serveur",sender:"bot"}),u()}}function u(){T(()=>{const s=document.querySelector('[ref="chatContainer"]');s&&(s.scrollTop=s.scrollHeight)})}return(s,a)=>{const x=y("model-viewer");return r(),l("div",q,[e("div",V,[i.agent.avatar_url?(r(),b(x,{key:0,src:i.agent.avatar_url,bounds:"tight","camera-target":"0m 1.60m 0m","camera-orbit":"0deg 90deg 0.9m","field-of-view":"15deg","interaction-prompt":"none",style:{width:"180px",height:"190px",background:"transparent"},"shadow-intensity":"0.6"},null,8,["src"])):(r(),l("img",D))]),e("div",E,[(r(!0),l(w,null,k(n.value,(o,h)=>(r(),l("div",{key:h,class:m(["flex",o.sender==="user"?"justify-end":"justify-start"])},[e("div",{class:m(["max-w-md p-3 rounded-xl",o.sender==="user"?"bg-blue-500 text-white":"bg-gray-200 text-gray-800"])},v(o.text),3)],2))),128)),c.value?(r(),l("div",F,[e("div",H,v(i.agent.nom)+" est en train d'écrire... ",1)])):_("",!0)],512),e("div",K,[j(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=o=>t.value=o),placeholder:"Message",class:"flex-1 border rounded-lg px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300",onKeyup:B(p,["enter"])},null,544),[[C,t.value]]),e("button",{onClick:p,class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg"}," ➤ ")])])}}};export{S as default};
